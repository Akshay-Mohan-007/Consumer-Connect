<!--***************************************************************************************************************************************
 * NAME   : CC_LivingSituation
 * DESCRIPTION  :Living Situation Page
 *    
 * @AUTHOR   : Sayari Mandal
 * @DATE   : 11-15-2017
 *
 * MODIFICATION LOG:  
 * ***************************************************************************************************************************************
 * DEVELOPER               DATE               DESCRIPTION 
 * ***************************************************************************************************************************************
 * Sayari Mandal           11-15-2017         Initial Version
 * Debalina                11-15-2017         JS and Backend Integration
 * Pankaj				           11-23-2017		      Added an attribute
 * Akshay Mohan            12-11-2017         TKT-000823 fix JS compilation issue
 ****************************************************************************************************************************************-->


<aura:component controller="CC_LivingSituationController" extends="c:CC_BaseSuperComponent" implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickAction" access="global">
    
    <aura:handler name="init" value="{!this}" action="{!c.doInit}" />
    <aura:method name="save" action="{!c.save}" access="PUBLIC">
        <aura:attribute name="callback" type="Function"/>
    </aura:method>
    
    
    <aura:attribute name="sAppId" type="String"/>
    <aura:attribute name="currentlivingSituationOptions" type="List" />
    <aura:attribute name="preferredOptions" type="List" />
    
    <aura:attribute name="bIsErrorCurrent" type="boolean" default="false"/>
    <aura:attribute name="bIsErrorCurrentOther" type="boolean" default="false"/>
    <aura:attribute name="bErrIsWorking" type="boolean" default="false"/>
    <aura:attribute name="bIsErrorPreferred" type="boolean" default="false"/>
    <aura:attribute name="bIsErrorPreferredOther" type="boolean" default="false"/>
    
    <aura:attribute name="bIsError" type="boolean" default="false"/>    
    
    <aura:attribute name="lstErrors" type="List" default="[]"/>
    <aura:attribute name="isLivingSituationWorking" type="Boolean" />
    <aura:attribute name="otherLabel" type="String"/>
    <aura:attribute name="objApplication" 
                    type="CC_Application__c" 
                    default="{ sobjectType: 'CC_Application__c',
                             CC_Where_does_the_individual_live__c: '',
                             CC_Is_Living_Situation_Working__c: false,
                             CC_Where_do_you_Prefer__c:'',
                             CC_Explain_living_situation__c:'',
                             CC_Explain_Where_do_you_prefer__c:''
                             }" />
    
    <aura:attribute name="bIsReadOnly" type="boolean" default="false"/> 
    <aura:attribute name="mapLabels" type="Map"/>
    
    <c:CC_SubPageHeader iconName="standard:household" pageName="{!v.mapLabels.CC_Label_LivingSituation}" errorListShow="{!v.lstErrors.length> 0}" lstErrors='{!v.lstErrors}'></c:CC_SubPageHeader>
    
    
    <lightning:layout horizontalAlign="left" multipleRows="true">
        <lightning:layoutItem flexibility="grow" padding="around-small" size="12" largeDeviceSize="6" mediumDeviceSize="6" smallDeviceSize="12">
            <lightning:select name="" 
                              label="{!v.mapLabels.CC_Label_CurrentLiving}" 
                              aura:id="currentLiving" 
                              disabled="{!v.bIsReadOnly}"
                              value="{!v.objApplication.CC_Where_does_the_individual_live__c}"
                              class="{!and(v.bIsError,empty(v.objApplication.CC_Where_does_the_individual_live__c))? 'slds-has-error required-asterisk':'required-asterisk'}">
                <option text="{!$Label.c.CC_LBL_SELECT}" value=""/>
                <aura:iteration items="{!v.currentlivingSituationOptions}" var="item">
                    <option text="{!item.sKey}" value="{!item.sValue}" selected ="{! item.sKey == v.objApplication.CC_Where_does_the_individual_live__c}"/>
                </aura:iteration>
            </lightning:select>
        </lightning:layoutItem>
    </lightning:layout>
    
    <aura:if isTrue="{!equals(v.objApplication.CC_Where_does_the_individual_live__c,$Label.c.CC_LBL_OTHER)}"> 
        <lightning:layout horizontalAlign="left" multipleRows="true">
            <lightning:layoutItem flexibility="grow" padding="around-small" size="12" largeDeviceSize="6" mediumDeviceSize="6" smallDeviceSize="12">
                <lightning:textarea name="" 
                                    value="{!v.objApplication.CC_Explain_living_situation__c}" 
                                    label="{!v.mapLabels.CC_Label_CurrentLivingDescription}" 
                                    maxlength="1000" 
                                    aura:id="currentLivingComment"
                                    disabled="{!v.bIsReadOnly}"
                                    class="{!and(v.bIsError,empty(v.objApplication.CC_Explain_living_situation__c))? 'slds-has-error required-asterisk':'required-asterisk'}"/>
            </lightning:layoutItem>
        </lightning:layout>
    </aura:if>
    
    
    <lightning:layout horizontalAlign="left" multipleRows="true">
        <lightning:layoutItem flexibility="grow" padding="around-small" size="12" largeDeviceSize="6" mediumDeviceSize="6" smallDeviceSize="12">
            
            <lightning:input value="{!v.objApplication.CC_Is_Living_Situation_Working__c}" 
                             type="toggle" 
                             class=""
                             label="{!v.mapLabels.CC_Label_IsCurrentLivingWorking}" 
                             name="" 
                             disabled="{!v.bIsReadOnly}"
                             checked="{!v.objApplication.CC_Is_Living_Situation_Working__c}"
                             onchange="{!c.resetFields}"
                             
                             />
        </lightning:layoutItem>
    </lightning:layout>
    
    
    <aura:if isTrue="{!v.objApplication.CC_Is_Living_Situation_Working__c == false}">
        <lightning:layout horizontalAlign="left" multipleRows="true">
            <lightning:layoutItem flexibility="grow" padding="around-small" size="12" largeDeviceSize="6" mediumDeviceSize="6" smallDeviceSize="12">
                <lightning:select name="" 
                                  class="{! and(v.bIsError, empty(v.objApplication.CC_Where_do_you_Prefer__c), not(v.objApplication.CC_Is_Living_Situation_Working__c))? 'slds-has-error required-asterisk':'required-asterisk'}"
                                  value="{!v.objApplication.CC_Where_do_you_Prefer__c}"
                                  label="{!v.mapLabels.CC_Label_PreferredLiving}" 
                                  aura:id="preferredLiving"
                                  disabled="{!v.bIsReadOnly}">
                    <option text="{!$Label.c.CC_LBL_SELECT}" value=""/>
                    <aura:iteration items="{!v.preferredOptions}" var="item">
                        <option text="{!item.sKey}" value="{!item.sValue}" selected ="{! item.sKey == v.objApplication.CC_Where_do_you_Prefer__c}"/>
                    </aura:iteration>
                </lightning:select>
            </lightning:layoutItem>
        </lightning:layout>
    </aura:if>
    <aura:if isTrue="{!equals(v.objApplication.CC_Where_do_you_Prefer__c,$Label.c.CC_LBL_OTHER)}"> 
        <lightning:layout horizontalAlign="left" multipleRows="true">
            <lightning:layoutItem flexibility="grow" padding="around-small" size="12" largeDeviceSize="6" mediumDeviceSize="6" smallDeviceSize="12">
                <lightning:textarea name="" 
                                    value="{!v.objApplication.CC_Explain_Where_do_you_prefer__c}" 
                                    label="{!v.mapLabels.CC_Label_PreferredLivingDescription}" 
                                    maxlength="1000"
                                    aura:id="preferredLivingComment"
                                    disabled="{!v.bIsReadOnly}"
                                    class="{!and(v.bIsError,empty(v.objApplication.CC_Explain_Where_do_you_prefer__c),equals(v.objApplication.CC_Where_do_you_Prefer__c,$Label.c.CC_LBL_OTHER))? 'slds-has-error required-asterisk':'required-asterisk'}"
                                    />
            </lightning:layoutItem>
        </lightning:layout>
    </aura:if>
    
    
    <!--  <lightning:layout horizontalAlign="left" multipleRows="true">
    <lightning:layoutItem flexibility="grow" padding="around-small" size="12" largeDeviceSize="12" mediumDeviceSize="12" smallDeviceSize="12">
          <lightning:button variant="brand" label="Back" onclick="{}"/>
          <lightning:button variant="brand" label="Next" onclick="{!c.save}"/>
      </lightning:layoutItem>
  </lightning:layout> -->
    
</aura:component>